webpackJsonp([33],{"8T6a":function(e,r){},LYzU:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("NYxO"),s=t("CCn6"),o=t("95YI"),i=t.n(o),n=t("USSz"),d=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e};function c(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function m(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function a(s,o){try{var i=r[s](o),n=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(n).then(function(e){a("next",e)},function(e){a("throw",e)});e(n)}("next")})}}var l={name:"orderConfirm",data:function(){return{addressVisible:!1,invoiceType:"1",personForm:{invoice_id:"",titleP:"",addressP:"",phoneP:""},companyForm:{invoice_id:"",ename:"",taxnumber:"",address:"",phone:"",bank:"",banknumber:""},submitAddType:0,addList:[],address:[],goods:[],orderDetail:[],addForm:{add_id:"",place:"",address_detail:"",mobile:"",name:"",province:"",city:"",area:""},formLabelWidth:"90px",value:[],selArea:!1,form:{goodsId:"",speId:"",number:"",needInvoice:!1,distribution:"normal",type:0},addRules:{place:[{required:!0,type:"string",message:"请选择所在地区"}],address_detail:[{required:!0,type:"string",message:"请填写详细地址",trigger:"blur"}],name:[{required:!0,type:"string",message:"请填写收货人",trigger:"blur"}],mobile:[{required:!0,message:"请填写手机号码"},{type:"number",message:"手机号必须为数字值"}]},personRules:{titleP:[{required:!0,message:"请输入名称",trigger:"blur"}],addressP:[{required:!0,message:"请填写地址",trigger:"blur"}],phoneP:[{required:!0,message:"请输入手机号",trigger:"blur"}]},companyRules:{ename:[{required:!0,message:"请输入公司名称",trigger:"blur"}],taxnumber:[{required:!0,message:"请输入公司税号",trigger:"blur"}],address:[{required:!0,message:"请填写开票地址",trigger:"blur"}],phone:[{required:!0,message:"请输入电话号码",trigger:"blur"}],bank:[{required:!0,message:"请输入开户银行",trigger:"blur"}],banknumber:[{required:!0,message:"请输入银行账号",trigger:"blur"}]}}},components:{VDistpicker:i.a,headTop:n.a},mounted:function(){this.getUserInfo(),this.initData()},computed:d({},Object(a.d)(["userInfo","choosedAddress"])),methods:d({},Object(a.b)(["getUserInfo"]),Object(a.c)(["CHOOSE_ADDRESS"]),{initData:function(){var e=this;return m(regeneratorRuntime.mark(function r(){var t,a,o,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.form.goodsId=e.$route.query.goodsId||"",e.form.speId=e.$route.query.speId||"",e.form.number=e.$route.query.number||0,e.form.type=e.$route.query.type?1:0,!e.userInfo||!e.userInfo.user_id){r.next=23;break}return r.next=7,Object(s.f)();case 7:for(t=r.sent,e.addList=[].concat(c(t)),a=0;a<t.length;a++)1==t[a].is_default&&(e.address=t[a]);return r.next=12,Object(s.k)(e.form.speId,e.form.number);case 12:return o=r.sent,e.orderDetail=o,console.log("orderRes"),console.log(o),e.goods=o.goodsInfo,r.next=19,Object(s.F)();case 19:for(i=r.sent,a=0;a<i.length;a++)0==i[a].type?e.companyForm=i[a]:e.personForm={invoice_id:i[a].invoice_id,titleP:i[a].title,addressP:i[a].address,phoneP:i[a].phone};r.next=23;break;case 23:case"end":return r.stop()}},r,e)}))()},onSelected:function(e){this.addForm.province=e.province.value,this.addForm.city=e.city.value,this.addForm.area=e.area.value,this.addForm.place=e.province.value+" "+e.city.value+" "+e.area.value,this.selArea=!1},checkBtn:function(e){for(var r=0;r<this.addList.length;r++)this.addList[r].add_id==e&&(this.address=this.addList[r])},submitAddForm:function(e){var r,t=this;this.$refs[e].validate((r=m(regeneratorRuntime.mark(function e(r){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=13;break}if(0!=t.submitAddType){e.next=7;break}return e.next=4,Object(s.a)(t.addForm.address_detail,t.addForm.mobile,t.addForm.name,t.addForm.province,t.addForm.city,t.addForm.area);case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,Object(s.s)(t.addForm.add_id,t.addForm.address_detail,t.addForm.mobile,t.addForm.name,t.addForm.province,t.addForm.city,t.addForm.area);case 9:a=e.sent;case 10:a&&(t.$message({message:a.msg,type:12e3==a.status?"success":"warning"}),12e3==a.status&&(t.initData(),t.addressVisible=!1)),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,t)})),function(e){return r.apply(this,arguments)}))},editAddress:function(e){var r=this;return m(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.submitAddType=1,r.addressVisible=!0,t.next=4,Object(s.t)(e);case 4:a=t.sent,r.addForm.add_id=a.address_id,r.addForm.place=a.province+" "+a.city+" "+a.district,r.addForm.address_detail=a.address_detail,r.addForm.mobile=parseInt(a.mobile),r.addForm.name=a.name,r.addForm.province=a.province,r.addForm.city=a.city,r.addForm.area=a.district;case 13:case"end":return t.stop()}},t,r)}))()},addAddress:function(){this.addList.length>=6?this.$message({message:"地址已达到上限，不能超过6条哦",type:"warning"}):(this.submitAddType=0,this.addForm={add_id:"",place:"",address_detail:"",mobile:"",name:"",province:"",city:"",area:""},this.addressVisible=!0)},submitInvoiceForm:function(e,r){var t,a=this;r=r||"",this.$refs[e].validate((t=m(regeneratorRuntime.mark(function e(t){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=13;break}if("0"!=a.invoiceType){e.next=7;break}return e.next=4,Object(s.d)(r,"",a.invoiceType,a.companyForm.taxnumber,a.companyForm.address,a.companyForm.banknumber,a.companyForm.phone,a.companyForm.bank,a.companyForm.ename);case 4:o=e.sent,e.next=10;break;case 7:return e.next=9,Object(s.d)(r,a.personForm.titleP,a.invoiceType,"",a.personForm.addressP,"",a.personForm.phoneP,"","");case 9:o=e.sent;case 10:12e3!=o.status&&a.$message({message:o.msg,type:"warning"}),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,a)})),function(e){return t.apply(this,arguments)}))},createOrder:function(){var e=this;return m(regeneratorRuntime.mark(function r(){var t,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t="","normal"==e.form.distribution&&(t=e.address.add_id?e.address.add_id:""),0!=e.form.type){r.next=9;break}return r.next=5,Object(s.O)("normal"==e.form.distribution?1:0,t,0==e.form.needInvoice?"":"0"==e.invoiceType?e.companyForm.invoice_id:e.personForm.invoice_id,0==e.form.needInvoice?0:1);case 5:(a=r.sent)&&(12e3==a.status?e.$router.push({path:"/order/pay",query:{orderId:""}}):e.$message({message:a.msg,type:"warning"})),r.next=13;break;case 9:return r.next=11,Object(s.P)("normal"==e.form.distribution?1:0,t,0==e.form.needInvoice?"":"0"==e.invoiceType?e.companyForm.invoice_id:e.personForm.invoice_id,0==e.form.needInvoice?0:1,e.form.speId?e.form.speId:"",e.form.goodsId?e.form.goodsId:"",e.form.number?e.form.number:"");case 11:(a=r.sent)&&(12e3==a.status?e.$router.push({path:"/order/pay",query:{orderId:a.orderId}}):e.$message({message:a.msg,type:"warning"}));case 13:case"end":return r.stop()}},r,e)}))()},checkForm:function(){var e,r,t=this;1==this.form.needInvoice?1==this.invoiceType?this.$refs.personForm.validate((r=m(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}t.submitInvoiceForm("personForm",t.personForm.invoice_id),t.createOrder(),e.next=6;break;case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}},e,t)})),function(e){return r.apply(this,arguments)})):this.$refs.companyForm.validate((e=m(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}t.submitInvoiceForm("companyForm",t.companyForm.invoice_id),t.createOrder(),e.next=6;break;case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}},e,t)})),function(r){return e.apply(this,arguments)})):this.createOrder()}}),created:function(){},watch:{userInfo:function(e){this.initData()}}},u={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("head-top",{attrs:{webActive:"home"}}),e._v(" "),t("div",{staticClass:"bgGray",attrs:{id:"orderConfirm"}},[t("div",{staticClass:"container"},[t("el-breadcrumb",{staticClass:"mb10",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),t("el-breadcrumb-item",[e._v("确认订单")])],1),e._v(" "),t("div",{staticClass:"orderBg"},[t("h1",{staticClass:"order_tit"},[e._v("送货方式")]),e._v(" "),t("div",{staticClass:"o_sendWay"},[t("el-radio-group",{model:{value:e.form.distribution,callback:function(r){e.$set(e.form,"distribution",r)},expression:"form.distribution"}},[t("el-radio",{attrs:{label:"normal",border:""}},[e._v("普通物流")]),e._v(" "),t("el-radio",{attrs:{label:"self",border:""}},[e._v("自提")])],1)],1),e._v(" "),"normal"==e.form.distribution?t("h1",{staticClass:" flex f-nowrap j-bet mb10 mt30"},[t("span",{staticClass:"order_tit mt10 mb0"},[e._v("收货地址")]),e._v(" "),t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(r){return e.addAddress()}}},[e._v("添加新地址")])],1):e._e(),e._v(" "),"normal"==e.form.distribution?t("div",{staticClass:"o_address"},[t("div",{staticClass:"o_a_item"},[t("div",{staticClass:"addBorder"}),e._v(" "),0!=e.address.length?t("div",{staticClass:"o_add_inbox"},[t("div",{staticClass:"o_a_info"},[t("div",{staticClass:"o_a_name flex f-nowrap j-bet"},[t("div",[t("i",{staticClass:"el-icon-success"}),e._v(e._s(e.address.name))]),e._v(" "),e.address.is_default?t("span",[e._v("默认")]):e._e()]),e._v(" "),t("div",{staticClass:"o_a_phone"},[e._v(e._s(e.address.phone))]),e._v(" "),t("div",{staticClass:"o_a_address wto"},[e._v(e._s(e.address.address))])]),e._v(" "),t("div",{staticClass:"o_a_arrow"},[t("el-button",{attrs:{icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.editAddress(e.address.add_id)}}},[e._v("编辑")])],1)]):0==e.addList.length?t("div",{staticClass:"mt10 f16"},[e._v("您还未填写过任何收货地址")]):t("div",{staticClass:"mt10 f16"},[e._v("请选择收货地址")])]),e._v(" "),e._l(e.addList,function(r,a){return r.add_id!=e.address.add_id?t("div",{key:a,staticClass:"o_list_info flex f-nowrap"},[t("div",{staticClass:"o_list_check"},[t("el-radio",{attrs:{value:"false"},on:{change:function(t){return e.checkBtn(r.add_id)}}})],1),e._v(" "),t("div",{staticClass:"o_list_name  flex f-nowrap j-bet"},[t("div",{staticClass:"wto"},[e._v(e._s(r.name))]),e._v(" "),r.is_default?t("span",[e._v("默认")]):e._e()]),e._v(" "),t("div",{staticClass:"o_list_phone"},[e._v(e._s(r.phone))]),e._v(" "),t("div",{staticClass:"o_list_addr wto"},[e._v(e._s(r.address))])]):e._e()}),e._v(" "),t("el-dialog",{attrs:{title:"收货地址",visible:e.addressVisible},on:{"update:visible":function(r){e.addressVisible=r}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"所在地区",prop:"place"}},[t("el-input",{staticStyle:{display:"none"},attrs:{type:"text",placeholder:"省份、城市、区",autocomplete:"off"},on:{focus:function(r){e.selArea=!0}},model:{value:e.addForm.province+" "+e.addForm.city+" "+e.addForm.area,callback:function(r){e.$set(e.addForm.province+" "+e.addForm.city+" "+e.addForm,"area",r)},expression:"addForm.province+' '+addForm.city+' '+addForm.area"}}),e._v(" "),t("v-distpicker",{staticClass:"placeInput",attrs:{province:e.addForm.province,city:e.addForm.city,area:e.addForm.area},on:{selected:e.onSelected}})],1),e._v(" "),t("el-form-item",{attrs:{label:"详细地址",prop:"address_detail"}},[t("el-input",{attrs:{type:"textarea",placeholder:"详细地址，如街道，楼盘号等"},model:{value:e.addForm.address_detail,callback:function(r){e.$set(e.addForm,"address_detail",r)},expression:"addForm.address_detail"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"收货人",prop:"name"}},[t("el-input",{model:{value:e.addForm.name,callback:function(r){e.$set(e.addForm,"name",r)},expression:"addForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[t("el-input",{model:{value:e.addForm.mobile,callback:function(r){e.$set(e.addForm,"mobile",e._n(r))},expression:"addForm.mobile"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(r){e.addressVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitAddForm("addForm")}}},[e._v("确 定")])],1)],1)],2):e._e(),e._v(" "),t("h1",{staticClass:"order_tit mt30"},[e._v("订单信息")]),e._v(" "),t("div",{staticClass:"o_confirm"},[e._m(0),e._v(" "),t("div",{staticClass:"oc_table"},e._l(e.goods,function(r,a){return t("div",{key:a,staticClass:"oc_list"},[t("div",{staticClass:"oc_info"},[t("div",{staticClass:"oc_pic"},[t("img",{attrs:{src:r.pic}})]),e._v(" "),t("div",{staticClass:"oc_message"},[t("h2",{staticClass:"color3"},[e._v(e._s(r.name))]),e._v(" "),t("p",{staticClass:"color9 f12"},[e._v(e._s(r.spec_name)+e._s(r.spec_unit))])])]),e._v(" "),t("div",{staticClass:"oc_num"},[e._v("×"+e._s(r.number))]),e._v(" "),t("div",{staticClass:"oc_unit "},[e._v("￥"+e._s(r.price)+"/"+e._s(r.supply_unit))]),e._v(" "),t("div",{staticClass:"oc_count colorPrice"},[e._v("￥"+e._s(r.number*(100*r.price)/100))])])}),0)]),e._v(" "),t("h1",{staticClass:"order_tit mt30"},[e._v("\n                        开票信息\n                    ")]),e._v(" "),t("div",{staticClass:"o_invoice"},[t("div",{staticClass:"w"},[e._v("\n                            需要开具发票\n                            "),t("el-switch",{model:{value:e.form.needInvoice,callback:function(r){e.$set(e.form,"needInvoice",r)},expression:"form.needInvoice"}})],1),e._v(" "),e.form.needInvoice?t("div",{staticClass:"invoiceForm"},[t("div",{staticClass:"m_sel"},[t("div",{staticClass:"m_tit"},[e._v("选择类型：")]),e._v(" "),t("div",{staticClass:"m_choice"},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.invoiceType,callback:function(r){e.invoiceType=r},expression:"invoiceType"}},[t("el-radio",{attrs:{label:"1",border:""}},[e._v("个人")]),e._v(" "),t("el-radio",{attrs:{label:"0",border:""}},[e._v("企业")])],1)],1)]),e._v(" "),"1"==e.invoiceType?t("div",[t("el-form",{ref:"personForm",attrs:{model:e.personForm,rules:e.personRules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"名称",prop:"titleP"}},[t("el-input",{model:{value:e.personForm.titleP,callback:function(r){e.$set(e.personForm,"titleP",r)},expression:"personForm.titleP"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"地址",prop:"addressP"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.personForm.addressP,callback:function(r){e.$set(e.personForm,"addressP",r)},expression:"personForm.addressP"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电话号码",prop:"phoneP"}},[t("el-input",{model:{value:e.personForm.phoneP,callback:function(r){e.$set(e.personForm,"phoneP",r)},expression:"personForm.phoneP"}})],1)],1)],1):t("div",[t("el-form",{ref:"companyForm",attrs:{model:e.companyForm,rules:e.companyRules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"公司名称",prop:"ename"}},[t("el-input",{model:{value:e.companyForm.ename,callback:function(r){e.$set(e.companyForm,"ename",r)},expression:"companyForm.ename"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"公司税号",prop:"taxnumber"}},[t("el-input",{model:{value:e.companyForm.taxnumber,callback:function(r){e.$set(e.companyForm,"taxnumber",r)},expression:"companyForm.taxnumber"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"开票地址",prop:"address"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.companyForm.address,callback:function(r){e.$set(e.companyForm,"address",r)},expression:"companyForm.address"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电话号码",prop:"phone"}},[t("el-input",{model:{value:e.companyForm.phone,callback:function(r){e.$set(e.companyForm,"phone",r)},expression:"companyForm.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"开户银行",prop:"bank"}},[t("el-input",{model:{value:e.companyForm.bank,callback:function(r){e.$set(e.companyForm,"bank",r)},expression:"companyForm.bank"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"银行账号",prop:"banknumber"}},[t("el-input",{model:{value:e.companyForm.banknumber,callback:function(r){e.$set(e.companyForm,"banknumber",r)},expression:"companyForm.banknumber"}})],1)],1)],1)]):e._e()]),e._v(" "),t("el-divider"),e._v(" "),t("div",{staticClass:"orderText"},[t("div",{staticClass:"orderT_list"},[t("div",{staticClass:"mb10"},[e._v("共"),t("span",{staticClass:"colorPrice"},[e._v(e._s(e.orderDetail.checkedGoodsCount))]),e._v("件商品")]),e._v(" "),t("div",{staticClass:"mb10"},[e._v("实付金额："),t("span",{staticClass:"colorPrice realPay"},[e._v(e._s(e.orderDetail.checkedGoodsAmount)+"元")])]),e._v(" "),"normal"==e.form.distribution&&e.address.address?t("div",{staticClass:"color3"},[t("label",[e._v("寄送至：")]),e._v(e._s(e.address.address))]):e._e(),e._v(" "),"normal"==e.form.distribution&&e.address.name?t("div",{staticClass:"color3"},[t("label",[e._v("收货人：")]),e._v(e._s(e.address.name)+" "+e._s(e.address.phone))]):e._e()]),e._v(" "),t("el-button",{staticClass:"orderBtn",attrs:{type:"primary"},on:{click:function(r){return e.checkForm()}}},[e._v("生成订单")])],1)],1)],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"o_c_head"},[r("div",{staticClass:"oc_info"},[this._v("订单详情")]),this._v(" "),r("div",{staticClass:"oc_num"},[this._v("数量")]),this._v(" "),r("div",{staticClass:"oc_unit"},[this._v("单价")]),this._v(" "),r("div",{staticClass:"oc_count"},[this._v("小计")])])}]};var p=t("VU/8")(l,u,!1,function(e){t("8T6a")},"data-v-478d3cec",null);r.default=p.exports}});
//# sourceMappingURL=33.3574c25d9e9fbe1866d2.js.map