webpackJsonp([28],{P0ER:function(e,t){},pu5Z:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("gvrZ"),i=s("CCn6");function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return function o(i,n){try{var a=t[i](n),r=a.value}catch(e){return void s(e)}if(!a.done)return Promise.resolve(r).then(function(e){o("next",e)},function(e){o("throw",e)});e(r)}("next")})}}var a={name:"mEvaluate",data:function(){return{order_id:"",info:"",form:{goodsId:"",speId:"",content:"",goodsRank:5,photos:[]},fileList:[],dialogImageUrl:"",dialogVisible:!1}},components:{mheadTop:o.a},mounted:function(){this.initData()},computed:{},methods:{initData:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.order_id=e.$route.query.order_id||"",t.next=3,Object(i.A)(e.order_id);case 3:s=t.sent,e.info=s,e.form.goodsId=s.goods[0].goods_id,e.form.speId=s.goods[0].spec_id;case 7:case"end":return t.stop()}},t,e)}))()},handleChange:function(e,t){this.calculateFileList(t)},handleRemove:function(e,t){this.calculateFileList(t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleExceed:function(e,t){this.$message.warning("当前限制只能选择上传 5 张图片")},confirm:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=e.form.content){t.next=4;break}e.$message({message:"评价内容不能为空",type:"warning"}),t.next=10;break;case 4:return t.next=6,Object(i.c)(e.form.content,e.form.goodsId,e.form.speId,e.order_id,e.form.goodsRank,e.form.photos);case 6:s=t.sent,e.$message({message:s.msg,type:12e3==s.status?"success":"warning"}),o=e,setTimeout(function(){o.$router.push({path:"/userCenter/order/detail",query:{order_id:o.order_id}})},1e3);case 10:case"end":return t.stop()}},t,e)}))()},calculateFileList:function(e){for(var t=[],s=0;s<e.length;s++)t[s]=e[s].response;this.form.photos=t}},created:function(){}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("mhead-top",{attrs:{titleHead:"发表评价",lfIcon:"el-icon-arrow-left icon",lfUrl:"/userCenter/order/order",rgIcon:"el-icon-s-home icon",rgUrl:"/home"}}),e._v(" "),s("div",{staticClass:"mBg"},[s("div",{staticClass:"meva-pro"},[s("div",{staticClass:"m-eva-item"},[s("div",{staticClass:"mev-pic"},[s("el-image",{staticClass:"umev-image",attrs:{src:e.info.goods[0].pic,fit:"cover","preview-src-list":Array(e.info.goods[0].pic)}})],1),e._v(" "),s("div",{staticClass:"mev-info"},[s("div",{staticClass:"mev-name"},[e._v(e._s(e.info.goods[0].name))]),e._v(" "),s("div",{staticClass:"mev-spec w"},[s("span",[e._v("规格："+e._s(e.info.goods[0].spec_name)+e._s(e.info.goods[0].spec_unit))])]),e._v(" "),s("div",{staticClass:"mev-spec w"},[s("span",[e._v("￥"+e._s(e.info.goods[0].price)+"/"+e._s(e.info.goods[0].supply_unit))])])])])]),e._v(" "),s("div",{staticClass:"mev-form"},[s("div",{staticClass:"mev-f-box"},[s("form",[s("div",{staticClass:"meva-score"},[s("span",[e._v("评分")]),e._v(" "),s("div",{staticClass:"meva-star"},[s("el-rate",{attrs:{"show-score":"","text-color":"#ff9900"},model:{value:e.form.goodsRank,callback:function(t){e.$set(e.form,"goodsRank",t)},expression:"form.goodsRank"}})],1)]),e._v(" "),s("div",{staticClass:"pb10"},[s("el-input",{attrs:{type:"textarea",maxlength:"1000","show-word-limit":"",autosize:{minRows:4,maxRows:6},placeholder:"请输入内容"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),s("div",{staticClass:"meva-pic"},[s("el-upload",{staticClass:"picUploader",attrs:{action:"http://api.sixmol.com/api/v1/uploadComment",limit:5,"on-exceed":e.handleExceed,"list-type":"picture-card","on-change":e.handleChange,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[s("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e._v(" "),s("el-dialog",{staticClass:"pr",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}}),e._v(" "),s("i",{staticClass:"el-icon-error delIcon"})])],1)])])]),e._v(" "),s("div",{staticClass:"meva-subit",on:{click:function(t){return e.confirm()}}},[s("span",{staticClass:"tc w"},[e._v("提交评价")])])])],1)},staticRenderFns:[]};var c=s("VU/8")(a,r,!1,function(e){s("P0ER")},null,null);t.default=c.exports}});
//# sourceMappingURL=28.354efba5ee4e1163f906.js.map